{
    "info": {
        "title": "gChess API",
        "version": "1.0.0",
        "description": "A chess application built with Kotlin following Domain-Driven Design.\n\n## Features\n- User registration and authentication with JWT\n- Chess game creation with player validation\n- Move validation according to FIDE rules\n- Bitboard-based chess engine\n\n## Authentication\nMost endpoints require JWT authentication. Use the `/api/auth/login` endpoint\nto obtain a token, then include it in the `Authorization` header as `Bearer <token>`.",
        "contact": {
            "name": "gChess Team",
            "email": "gbourquet@gmail.com"
        }
    },
    "servers": [
        {
            "url": "http://localhost:8080",
            "description": "Local development server"
        }
    ],
    "paths": {
        "/api/games": {
            "post": {
                "tags": [
                    "Games"
                ],
                "summary": "Create a new chess game",
                "description": "Create a new game between two players. Both players must exist in the system.",
                "parameters": [
                ],
                "requestBody": {
                    "description": "Player IDs for white and black",
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreateGameRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "201": {
                        "description": "Game successfully created",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/GameDTO"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid player IDs or players don't exist",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Map-String-String"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Missing or invalid JWT token",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Map-String-String"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "JWT": [
                        ]
                    },
                    {
                        "jwt-auth": [
                        ]
                    }
                ]
            },
            "parameters": [
            ]
        },
        "/api/games/{id}/moves": {
            "post": {
                "tags": [
                    "Games"
                ],
                "summary": "Make a chess move",
                "description": "Make a move in a game. The player ID is extracted from the JWT token and validated.",
                "parameters": [
                ],
                "requestBody": {
                    "description": "Move to execute (algebraic notation)",
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/MoveRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Move successfully executed",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/GameDTO"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid move, not player's turn, or game already finished",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Map-String-String"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Missing or invalid JWT token",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Map-String-String"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "JWT": [
                        ]
                    },
                    {
                        "jwt-auth": [
                        ]
                    }
                ]
            },
            "parameters": [
                {
                    "name": "id",
                    "in": "path",
                    "schema": {
                        "type": "string"
                    },
                    "description": "Game ID (ULID format)"
                }
            ]
        },
        "/api/games/{id}": {
            "get": {
                "tags": [
                    "Games"
                ],
                "summary": "Get game by ID",
                "description": "Retrieve the current state of a chess game by its ID. No authentication required.",
                "parameters": [
                ],
                "responses": {
                    "200": {
                        "description": "Game found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/GameDTO"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid game ID format",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/String"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Game not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/String"
                                }
                            }
                        }
                    }
                }
            },
            "parameters": [
                {
                    "name": "id",
                    "in": "path",
                    "schema": {
                        "type": "string"
                    },
                    "description": "Game ID (ULID format)"
                }
            ]
        },
        "/api/auth/register": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Register a new user",
                "description": "Create a new user account with username, email, and password",
                "parameters": [
                ],
                "requestBody": {
                    "description": "User registration information",
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/RegisterRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "201": {
                        "description": "Successfully created user",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/UserDTO"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Registration failed (username/email already taken, invalid password, etc.)",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Map-String-String"
                                }
                            }
                        }
                    }
                }
            },
            "parameters": [
            ]
        },
        "/api/auth/login": {
            "post": {
                "tags": [
                    "Authentication"
                ],
                "summary": "Login",
                "description": "Authenticate a user and receive a JWT token",
                "parameters": [
                ],
                "requestBody": {
                    "description": "User credentials",
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/LoginRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Successfully authenticated - returns user info and JWT token",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/LoginResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Invalid credentials",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Map-String-String"
                                }
                            }
                        }
                    }
                }
            },
            "parameters": [
            ]
        },
        "/api/users/{id}": {
            "get": {
                "tags": [
                    "Users"
                ],
                "summary": "Get user by ID",
                "description": "Retrieve user information by player ID",
                "parameters": [
                ],
                "responses": {
                    "200": {
                        "description": "User found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/UserDTO"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid user ID format",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Map-String-String"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Map-String-String"
                                }
                            }
                        }
                    }
                }
            },
            "parameters": [
                {
                    "name": "id",
                    "in": "path",
                    "schema": {
                        "type": "string"
                    },
                    "description": "User ID (ULID format)"
                }
            ]
        },
        "/api/matchmaking/queue": {
            "post": {
                "tags": [
                    "Matchmaking"
                ],
                "summary": "Join matchmaking queue",
                "description": "Add the authenticated player to the matchmaking queue.\n\nIf another player is already waiting, a match is created automatically:\n- Colors are assigned randomly (50/50)\n- A chess game is created\n- Both players receive MATCHED status\n\nIf no other player is waiting:\n- Player is added to queue with WAITING status\n- Poll GET /api/matchmaking/status to check for match",
                "parameters": [
                ],
                "responses": {
                    "200": {
                        "description": "Matchmaking status (WAITING or MATCHED)",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/MatchmakingStatusDTO"
                                }
                            }
                        }
                    },
                    "409": {
                        "description": "Player already in queue or already matched",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Map-String-String"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Player does not exist",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Map-String-String"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Missing or invalid JWT token",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Map-String-String"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "JWT": [
                        ]
                    },
                    {
                        "jwt-auth": [
                        ]
                    }
                ]
            },
            "delete": {
                "tags": [
                    "Matchmaking"
                ],
                "summary": "Leave matchmaking queue",
                "description": "Remove the authenticated player from the matchmaking queue.\n\nIf the player is not in queue, this operation succeeds silently.\n\nNote: Once matched, players cannot leave via this endpoint.\nThe match has already been created and they should join the game.",
                "parameters": [
                ],
                "responses": {
                    "200": {
                        "description": "Success (removed: true if was in queue, false otherwise)",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Map-String-Boolean"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Missing or invalid JWT token",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Map-String-String"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "JWT": [
                        ]
                    },
                    {
                        "jwt-auth": [
                        ]
                    }
                ]
            },
            "parameters": [
            ]
        },
        "/api/matchmaking/status": {
            "get": {
                "tags": [
                    "Matchmaking"
                ],
                "summary": "Get matchmaking status",
                "description": "Get the current matchmaking status for the authenticated player.\n\nPossible statuses:\n- WAITING: Player is in queue, waiting for an opponent\n- MATCHED: Player has been matched, game created\n- NOT_FOUND: Player is neither in queue nor matched\n\nWhen MATCHED, the response includes:\n- gameId: ID of the created game\n- yourColor: WHITE or BLACK (randomly assigned)\n\nClients should poll this endpoint periodically (e.g., every 2-3 seconds)\nto check for match updates.",
                "parameters": [
                ],
                "responses": {
                    "200": {
                        "description": "Current matchmaking status",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/MatchmakingStatusDTO"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Missing or invalid JWT token",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Map-String-String"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "JWT": [
                        ]
                    },
                    {
                        "jwt-auth": [
                        ]
                    }
                ]
            },
            "parameters": [
            ]
        }
    },
    "components": {
        "schemas": {
            "GameDTO": {
                "type": "object",
                "properties": {
                    "blackPlayer": {
                        "type": "string"
                    },
                    "board": {
                        "$ref": "#/components/schemas/ChessPositionDTO"
                    },
                    "currentPlayer": {
                        "type": "string"
                    },
                    "currentSide": {
                        "type": "string"
                    },
                    "id": {
                        "type": "string"
                    },
                    "isCheck": {
                        "oneOf": [
                            {
                            },
                            {
                                "type": "boolean"
                            }
                        ]
                    },
                    "moveHistory": {
                        "items": {
                            "$ref": "#/components/schemas/MoveDTO"
                        }
                    },
                    "status": {
                        "type": "string"
                    },
                    "whitePlayer": {
                        "type": "string"
                    }
                },
                "required": [
                    "blackPlayer",
                    "board",
                    "currentPlayer",
                    "currentSide",
                    "id",
                    "moveHistory",
                    "status",
                    "whitePlayer"
                ]
            },
            "ChessPositionDTO": {
                "type": "object",
                "properties": {
                    "fen": {
                        "type": "string"
                    }
                },
                "required": [
                    "fen"
                ]
            },
            "MoveDTO": {
                "type": "object",
                "properties": {
                    "from": {
                        "type": "string"
                    },
                    "to": {
                        "type": "string"
                    }
                },
                "required": [
                    "from",
                    "to"
                ]
            },
            "Map-String-String": {
                "additionalProperties": {
                    "type": "string"
                }
            },
            "CreateGameRequest": {
                "type": "object",
                "properties": {
                    "blackPlayerId": {
                        "type": "string"
                    },
                    "initialPosition": {
                        "oneOf": [
                            {
                            },
                            {
                                "type": "string"
                            }
                        ]
                    },
                    "whitePlayerId": {
                        "type": "string"
                    }
                },
                "required": [
                    "blackPlayerId",
                    "whitePlayerId"
                ]
            },
            "MoveRequest": {
                "type": "object",
                "properties": {
                    "from": {
                        "type": "string"
                    },
                    "promotion": {
                        "oneOf": [
                            {
                            },
                            {
                                "type": "string"
                            }
                        ]
                    },
                    "to": {
                        "type": "string"
                    }
                },
                "required": [
                    "from",
                    "to"
                ]
            },
            "String": {
                "type": "string"
            },
            "UserDTO": {
                "type": "object",
                "properties": {
                    "email": {
                        "type": "string"
                    },
                    "id": {
                        "type": "string"
                    },
                    "username": {
                        "type": "string"
                    }
                },
                "required": [
                    "email",
                    "id",
                    "username"
                ]
            },
            "RegisterRequest": {
                "type": "object",
                "properties": {
                    "email": {
                        "type": "string"
                    },
                    "password": {
                        "type": "string"
                    },
                    "username": {
                        "type": "string"
                    }
                },
                "required": [
                    "email",
                    "password",
                    "username"
                ]
            },
            "LoginResponse": {
                "type": "object",
                "properties": {
                    "message": {
                        "type": "string"
                    },
                    "token": {
                        "type": "string"
                    },
                    "user": {
                        "$ref": "#/components/schemas/UserDTO"
                    }
                },
                "required": [
                    "token",
                    "user"
                ]
            },
            "LoginRequest": {
                "type": "object",
                "properties": {
                    "password": {
                        "type": "string"
                    },
                    "username": {
                        "type": "string"
                    }
                },
                "required": [
                    "password",
                    "username"
                ]
            },
            "Map-String-Boolean": {
                "additionalProperties": {
                    "type": "boolean"
                }
            },
            "MatchmakingStatusDTO": {
                "type": "object",
                "properties": {
                    "gameId": {
                        "oneOf": [
                            {
                            },
                            {
                                "type": "string"
                            }
                        ]
                    },
                    "queuePosition": {
                        "oneOf": [
                            {
                            },
                            {
                                "type": "number",
                                "format": "int32"
                            }
                        ]
                    },
                    "status": {
                        "type": "string"
                    },
                    "yourColor": {
                        "oneOf": [
                            {
                            },
                            {
                                "type": "string"
                            }
                        ]
                    }
                },
                "required": [
                    "status"
                ]
            }
        }
    }
}